const mix=require("laravel-mix"),glob=require("glob"),path=require("path"),chokidar=require("chokidar");require("colors");const MixGlob=function(){function i(i,e){return"string"==typeof e?e:!(!e||!e.hasOwnProperty(i))&&e[i]}function e(e,t,n){var p=i(e,t);return p||i(e,n)}var t,n={sass:{mapExt:"css"},js:{mapExt:"js"}};function p(i,t){let p=null;return n[i]&&(p=n[i].mapExt),function(i,t,n){const p=e(i,t,n);if(p)return p;throw"defaultMapExt: no mapping precised, neither it's supported by default"}(i,t,p)}function o(i){i&&i.mapping&&(this.mappping=i.mapping),i&&i.mapping||(this.mappping={}),this.mixInst=mix,Object.keys(mix).forEach((i,t)=>{["mix","config","scripts","styles"].includes(i)||(this[i]=function(t,n,o,r){const c=p(i,this.mapping.mapExt);return function i(t,n,p,o,r,c,s){const a=glob.sync(n);let l,m,u,f,h;s||chokidar.watch(n).on("add",e=>{console.log("File added ->".yellow),console.log(e),i.call(this,t,e,p,o,r,c,!1)});let x,g=c;if(r||(r={}),r.compileSpecifier||(r.compileSpecifier={}),!r.compileSpecifier.disabled){let i="compile";r.compileSpecifier.specifier&&(i=r.compileSpecifier.specifier),f=new RegExp("."+i+".(?!.*"+i+".)","g")}r.extMapping&&(g=r.extMapping),a.forEach(function(i){l=r.base?i.replace(r.base,""):i,r.compileSpecifier.disable||(l=l.replace(f,".")),u=path.extname(l).substr(1),h=new RegExp(u+"$","g"),x=e(u,g,c),u!==x&&(l=l.replace(h,x)),m=path.join(p,l),this.mixInst=o?this.mixInst[t](i,m,o):this.mixInst[t](i,m)})}.call(this,i,t,n,o,r,c),this}.bind(this))})}return(t=o.prototype).createMapping=function(i){},t.mix=function(i){return function(){return console.log(arguments),mix[i].apply(mix,arguments),this}.bind(this)},o}();module.exports=MixGlob;